# Release v1.1 - Улучшенный интерфейс и быстрый заказ

## Новый функционал

### Быстрый заказ
- **Рефакторинг системы заказов** для более быстрой обработки
- Улучшенная навигация между проектами
- Оптимизированная работа с базой данных

### Улучшенный интерфейс

**Новые кнопки:**
- Главное меню - быстрый доступ к основным функциям
- Помощь - подробная инструкция по использованию
- Очистить данные - удалить результаты анализа (файлы сохраняются)
- Удалить проект - полное удаление проекта с подтверждением
- Навигация - кнопки возврата на всех экранах

**Визуальные улучшения:**
- Иконки для всех кнопок (улучшенная визуальная навигация)
- Подтверждение удаления (защита от случайных действий)
- Кнопка "Главное меню" доступна везде
- Улучшенная структура меню (2 колонки)

## Улучшения парсинга

### Обработка остатков
- **Числовые остатки**: 1, 2, 10, 30 шт
- **Текстовые остатки**: "много", "мало", "достаточно"
- Отображение остатков в выходном файле

### Улучшенная фильтрация
- **Кеги**: показываются всегда (даже 1 штука)
- **Банки/бутылки**: только при остатке >= 10 штук
- Автоматическое определение типа тары

### Расширенное распознавание
- ПЭТ-кеги (20л, 30л)
- Жестяные банки (ж/б)
- Числовой литраж (автоопределение кег)
- Улучшенное распознавание цены за литр и за штуку

## Технические улучшения

### База данных
- Функция удаления проекта с каскадным удалением
- Функция очистки данных с возвратом количества удаленных записей
- Оптимизированные CRUD операции

### ML-модель классификатора
- Улучшенная классификация колонок прайс-листа
- Игнорирование технических колонок (ABV, OG, IBU)
- Расширенное распознавание колонки "Наличие"
- Приоритет ключевых слов над ML-предсказаниями

### Обработчики бота
- Новый роутер для навигации
- Улучшенная обработка ошибок
- Расширенная система помощи с инструкциями
- Оптимизированная обработка callback-запросов

## Безопасность

### Конфиденциальность данных
- Обновленный `.gitignore` для защиты данных
- Исключение токенов и БД из Git
- Исключение пользовательских файлов и логов
- Расширенная документация по безопасности

**Защищенные файлы:**
- `.env` - токены и конфигурация
- `*.db` - база данных
- `data/projects/` - файлы пользователей
- `*.log` - логи приложения

## Документация

**Обновленные файлы:**
- `README.md` - актуализированная документация
- `SECURITY.md` - рекомендации по безопасности
- `CHANGELOG.md` - полная история изменений

## Статистика

**Поддерживаемые форматы:**
- Beeribo: 182 позиции (79 кег, 88 банок, 15 бутылок)
- CBD: 453 позиции (106 кег, 385 банок, 25 бутылок)
- Paradox: 102 позиции

**Точность обработки:**
- Распознавание колонок: 95%+
- Извлечение объемов: 98%+
- Классификация тары: 100%

## Исправления

- Исправлена обработка пустых остатков
- Улучшена обработка нестандартных форматов прайс-листов
- Исправлены ошибки при удалении проектов
- Оптимизирована работа с памятью при обработке больших файлов

## Обновление

```bash
# Получить последнюю версию
cd /path/to/postavki-bot
git pull origin main
git checkout v1.1

# Обновить зависимости
source venv/bin/activate
pip install -r requirements.txt --upgrade

# Переобучить ML-модель (опционально)
PYTHONPATH=. python -m ml.train_detector

# Запустить бота
python run_bot.py
```

## Миграция с v1.0

Версия v1.1 полностью совместима с v1.0. База данных остается без изменений.
Все существующие проекты и заказы будут работать без дополнительных действий.

## Что дальше

Планы на v1.2:
- История заказов с возможностью повтора
- Экспорт заказов в Excel
- Статистика по поставщикам и позициям
- Уведомления об изменении цен
- Поддержка групповых чатов

## Технологии

- **Python**: 3.13+
- **Telegram**: aiogram 3.16
- **Database**: SQLAlchemy 2.0 + aiosqlite
- **ML**: scikit-learn (TfidfVectorizer + MultinomialNB)
- **Excel**: pandas 2.2.3 + openpyxl 3.1.5

## Благодарности

Спасибо всем, кто помогал тестировать и предлагал улучшения!

